<!DOCTYPE html>
<meta charset="utf-8"/>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
          integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css"
          integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.6.1/css/bootstrap-slider.min.css"
          crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/base.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"
            integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
            crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-slider/10.6.1/bootstrap-slider.min.js"
            crossorigin="anonymous"></script>
    <script src="/static/js/webSocket.js/"></script>
    <script src="/static/js/music.js/"></script>
    <script src="/static/js/sound.js/"></script>
    <script src="/static/js/slider.js/"></script>
    <script src="/static/js/collapse.js/"></script>
</head>
<body>
<div id="toast-container" aria-live="polite" aria-atomic="true" class="position-fixed w-100 d-flex flex-column align-items-center">
</div>
<div class="container">
    <div class="headline">
        <h1 class="text-center">D&D Music Manager</h1>
    </div>
    <div class="row">
        <ul class="nav nav-tabs" role="tablist">
            <li class="nav-item col-6">
                <a class="nav-link active" id="music-tab" data-toggle="tab" href="#music" role="tab" aria-controls="music"
                   aria-selected="true">Music</a>
            </li>
            <li class="nav-item col-6">
                <a class="nav-link" id="sound-tab" data-toggle="tab" href="#sound" role="tab" aria-controls="sound"
                   aria-selected="false">Sound</a>
            </li>
        </ul>
    </div>
    <div class="tab-content">
        <div class="tab-pane fade show active" id="music" role="tabpanel" aria-labelledby="music-tab">
            <p>
                Now Playing
                <strong>
                    <span id="now-playing" class="ml-2">
                        {% if music.currently_playing %}
                            {{ music.currently_playing.0.name }} > {{ music.currently_playing.1.name }}
                        {% else %}
                            -
                        {% endif %}
                    </span>
                </strong>
            </p>
            <p>
                Stop the Music
                <button type="button" class="btn" onclick="stopMusic()">
                    <i class="fas fa-stop"></i>
                </button>
            </p>
            <p>
                Volume
                <input id="music-volume" type="text" data-slider-min="0" data-slider-max="100"
                       data-slider-step="5" data-slider-value="{{ music.volume }}"/>
            </p>
            <hr class="row">
            <div>
                {% for group in music.groups %}
                {% set outer_loop = loop %}
                <div>
                    <a class="row btn collapse-btn" data-toggle="collapse" href="#collapseMusicGroup{{outer_loop.index0}}" role="button"
                       aria-expanded="false" aria-controls="collapseMusicGroup{{outer_loop.index0}}">
                        <h5><i class="collapse-icon fas fa-plus fa-xs"></i>{{ group.name }}</h5>
                    </a>
                    <div class="collapse" id="collapseMusicGroup{{outer_loop.index0}}">
                        <div class="row">
                            {% if group.track_lists %}
                            {% for _track_list in group.track_lists %}
                            <div class="col-12 col-sm-6 col-xl-4 group-item">
                                <button type="button" class="btn {% if music.currently_playing
                                and music.currently_playing.0.name == group.name
                                and music.currently_playing.1.name == _track_list.name %}playing{% endif %}"
                                        id="btn-music-{{ outer_loop.index0 }}-{{ loop.index0 }}"
                                        onclick="playMusic({{ outer_loop.index0 }}, {{ loop.index0 }})">
                                    <i class="fas fa-play play-icon"></i>
                                    {{ _track_list.name }}
                                </button>
                            </div>
                            {% endfor %}
                            {% else %}
                            <div class="list-group-item">No track lists available.</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <hr class="row">
                {% endfor %}
            </div>
        </div>
        <div class="tab-pane fade" id="sound" role="tabpanel" aria-labelledby="sound-tab">
            <p>
                Volume
                <input id="sound-volume" type="text" data-slider-min="0" data-slider-max="1"
                       data-slider-step="0.05" data-slider-value="{{ sound.volume }}"/>
            </p>
            <hr class="row">
            <div>
                {% for group in sound.groups %}
                {% set outer_loop = loop %}
                <div>
                    <a class="row btn collapse-btn" data-toggle="collapse" href="#collapseSoundGroup{{outer_loop.index0}}" role="button"
                       aria-expanded="false" aria-controls="collapseSoundGroup{{outer_loop.index0}}">
                        <h5><i class="collapse-icon fas fa-plus fa-xs"></i>{{ group.name }}</h5>
                    </a>
                    <div class="collapse" id="collapseSoundGroup{{outer_loop.index0}}">
                        <div class="row">
                            {% if group.sounds %}
                            {% for _sound in group.sounds %}
                            <div class="col-12 col-sm-6 col-xl-4 group-item">
                                <button type="button" class="btn"
                                        onclick="playSound({{ outer_loop.index0 }}, {{ loop.index0 }})">
                                    <i class="fas fa-play play-icon"></i>
                                    {{ _sound.name }}
                                </button>
                            </div>
                            {% endfor %}
                            {% else %}
                            <div class="list-group-item">No sounds available</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <hr class="row">
                {% endfor %}
            </div>
        </div>
    </div>
</div>
</body>
</html>